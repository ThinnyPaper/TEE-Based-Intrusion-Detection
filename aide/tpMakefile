CC=gcc
CFLAGS=-I./include

# 源文件
SOURCES=src/aide.c include/aide.h \
	include/base64.h src/base64.c \
	include/be.h src/be.c \
	include/commandconf.h src/commandconf.c \
	include/attributes.h src/attributes.c \
	include/report.h src/report.c \
	include/conf_ast.h src/conf_ast.c \
	include/conf_eval.h src/conf_eval.c \
	include/conf_lex.h src/conf_lex.l  \
	src/conf_yacc.h src/conf_yacc.y \
	include/db.h src/db.c \
	include/db_config.h \
	include/db_disk.h src/db_disk.c \
	include/db_file.h src/db_file.c \
	include/db_lex.h src/db_lex.l \
	include/db_list.h src/db_list.c \
	include/do_md.h src/do_md.c \
	include/errorcodes.h \
	include/gen_list.h src/gen_list.c \
	src/getopt1.c \
	include/getopt.h src/getopt.c \
	include/hashsum.h src/hashsum.c \
	include/rx_rule.h src/rx_rule.c \
	include/list.h src/list.c \
	include/log.h src/log.c \
	include/md.h src/md.c \
	include/seltree_struct.h \
	include/seltree.h src/seltree.c \
	include/symboltable.h src/symboltable.c \
	include/types.h \
	include/url.h src/url.c\
	include/util.h src/util.c
# 对象文件，替换源文件路径中的 .c 为 .o
OBJS=$(SOURCES:.c=.o)

# 目标文件名
BINARY=idtt

# 默认目标
all: $(BINARY)

$(BINARY): $(OBJS)
	$(CC) $(LDFLAGS) $^ -o $@

# 通用规则，用于从每个 .c 文件生成 .o 文件
# 注意：$< 表示依赖列表中的第一个依赖文件，$@ 表示目标文件
%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

clean:
	rm -f $(OBJS) $(BINARY)

.PHONY: all clean

